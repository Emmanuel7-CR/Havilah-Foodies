<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Havilah Foodies - Admin Portal</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
     <link rel="stylesheet" href="admin.css">
    
</head>
<body>
    <!-- Login Page -->
    <div id="login-page" class="login-container">
        <div class="login-card">
            <div class="login-header">
                <h1>Havilah Foodies</h1>
                <p>Admin Portal</p>
            </div>
            
            <div id="login-alert" style="display: none;"></div>
            
            <form id="login-form">
                <div class="form-group">
                    <label class="form-label">Username</label>
                    <input type="text" class="form-control" id="username" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-control" id="password" required>
                </div>
                
                <button type="submit" class="btn-login">
                    <i class="fas fa-sign-in-alt me-2"></i>Login
                </button>
            </form>
            
            <div class="mt-3 text-center">
                <small class="text-muted">Demo Credentials: admin / admin123</small>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="dashboard">
        <!-- Mobile Menu Button -->
        <button class="mobile-menu-btn" id="mobile-menu-btn">
            <i class="fas fa-bars"></i>
        </button>
        
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>Havilah Foodies</h2>
                <p>Admin Portal</p>
            </div>
            
            <ul class="sidebar-menu">
                <li>
                    <a href="#" class="menu-link active" data-section="overview">
                        <i class="fas fa-home"></i>
                        <span>Overview</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="menu-link" data-section="menu-items">
                        <i class="fas fa-utensils"></i>
                        <span>Manage Menu Items</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="menu-link" data-section="specials">
                        <i class="fas fa-star"></i>
                        <span>Manage Specials</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="menu-link" data-section="gallery">
                        <i class="fas fa-images"></i>
                        <span>Manage Gallery</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="menu-link" data-section="reservations">
                        <i class="fas fa-calendar-check"></i>
                        <span>Reservations</span>
                    </a>
                </li>
            </ul>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Topbar -->
            <div class="topbar">
                <h3 id="page-title">Dashboard Overview</h3>
                <button class="btn-logout" id="logout-btn">
                    <i class="fas fa-sign-out-alt me-2"></i>Logout
                </button>
            </div>
            
            <!-- Overview Section -->
            <section id="section-overview" class="content-section active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-info">
                            <h5>Menu Items</h5>
                            <h3 id="total-menu-items">10</h3>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-utensils"></i>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-info">
                            <h5>Total Reservations</h5>
                            <h3 id="total-reservations">0</h3>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-calendar"></i>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-info">
                            <h5>Gallery Images</h5>
                            <h3 id="total-images">6</h3>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-images"></i>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-info">
                            <h5>Active Specials</h5>
                            <h3 id="active-specials">1</h3>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-star"></i>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h4>Welcome to Havilah Foodies Admin Portal</h4>
                    <p>Manage your restaurant's online presence with ease. Use the sidebar to navigate between different management sections:</p>
                    <ul>
                        <li><strong>Manage Menu Items:</strong> Add, edit, delete, and update menu items with prices, descriptions, and images</li>
                        <li><strong>Manage Specials:</strong> Update daily or weekly special offers with images and descriptions</li>
                        <li><strong>Manage Gallery:</strong> Upload, delete, and organize your restaurant's photo gallery</li>
                        <li><strong>Reservations:</strong> View and manage customer reservations</li>
                    </ul>
                </div>
            </section>
            
            <!-- Menu Items Management Section -->
            <section id="section-menu-items" class="content-section">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                        <h4 style="margin: 0;">Manage Menu Items</h4>
                        <button class="btn-primary-custom" onclick="showAddMenuItemModal()">
                            <i class="fas fa-plus me-2"></i>Add New Item
                        </button>
                    </div>
                    
                    <!-- Category Filter -->
                    <div class="form-group">
                        <label class="form-label">Filter by Category</label>
                        <select class="form-control" id="category-filter" onchange="filterMenuByCategory()">
                            <option value="all">All Categories</option>
                            <option value="breakfast">Breakfast</option>
                            <option value="appetizers">Appetizers & Salads</option>
                            <option value="pizza">Pizza</option>
                            <option value="pasta">Pasta</option>
                            <option value="mains">Main Courses</option>
                            <option value="burgers">Burgers & Sandwiches</option>
                            <option value="desserts">Desserts</option>
                            <option value="beverages">Beverages</option>
                        </select>
                    </div>
                    
                    <div id="menu-items-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; margin-top: 30px;">
                        <!-- Menu items will be loaded here -->
                    </div>
                </div>
            </section>
            
            <!-- Menu Item Modal -->
            <div id="menu-item-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; overflow-y: auto;">
                <div style="max-width: 700px; margin: 50px auto; background: white; border-radius: 15px; padding: 40px; position: relative;">
                    <button onclick="closeMenuItemModal()" style="position: absolute; top: 20px; right: 20px; background: none; border: none; font-size: 2rem; cursor: pointer; color: #666;">&times;</button>
                    
                    <h3 id="modal-title" style="color: var(--primary-color); margin-bottom: 30px;">Add Menu Item</h3>
                    
                    <form id="menu-item-form">
                        <input type="hidden" id="edit-item-id">
                        
                        <div class="form-group">
                            <label class="form-label">Item Name *</label>
                            <input type="text" class="form-control" id="item-name" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Category *</label>
                            <select class="form-control" id="item-category" required>
                                <option value="">Select Category</option>
                                <option value="breakfast">Breakfast</option>
                                <option value="appetizers">Appetizers & Salads</option>
                                <option value="pizza">Pizza</option>
                                <option value="pasta">Pasta</option>
                                <option value="mains">Main Courses</option>
                                <option value="burgers">Burgers & Sandwiches</option>
                                <option value="desserts">Desserts</option>
                                <option value="beverages">Beverages</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Description *</label>
                            <textarea class="form-control" id="item-description" rows="4" required></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Price (₦)</label>
                            <input type="number" class="form-control" id="item-price" placeholder="Optional - leave blank if no price">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Badge (Optional)</label>
                            <select class="form-control" id="item-badge">
                                <option value="">No Badge</option>
                                <option value="signature">Signature Dish</option>
                                <option value="popular">Popular Choice</option>
                                <option value="chef">Chef's Special</option>
                                <option value="vegetarian">Vegetarian</option>
                                <option value="new">New Item</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Item Image *</label>
                            <input type="file" class="form-control" id="item-image" accept="image/*">
                            <small class="text-muted">Current image will be kept if no new image is uploaded</small>
                            <img id="item-image-preview" class="preview-image" alt="Preview" style="margin-top: 15px;">
                        </div>
                        
                        <div style="display: flex; gap: 15px; margin-top: 30px;">
                            <button type="submit" class="btn-primary-custom" style="flex: 1;">
                                <i class="fas fa-save me-2"></i>Save Item
                            </button>
                            <button type="button" class="btn-secondary-custom" onclick="closeMenuItemModal()">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Specials Management Section -->
            <section id="section-specials" class="content-section">
                <div class="card">
                    <h4>Manage Daily/Weekly Specials</h4>
                    <p class="text-muted mb-4">Update your special offers to keep customers engaged</p>
                    
                    <form id="specials-form">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">Special Title</label>
                                    <input type="text" class="form-control" id="special-title" placeholder="e.g., Weekend Brunch Special" required>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">Special Type</label>
                                    <select class="form-control" id="special-type" required>
                                        <option value="daily">Daily Special</option>
                                        <option value="weekly">Weekly Special</option>
                                        <option value="seasonal">Seasonal Offer</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" id="special-description" rows="4" placeholder="Describe your special offer..." required></textarea>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">Original Price (₦)</label>
                                    <input type="number" class="form-control" id="special-original-price" placeholder="10000">
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">Special Price (₦)</label>
                                    <input type="number" class="form-control" id="special-price" placeholder="7500" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Special Image</label>
                            <input type="file" class="form-control" id="special-image" accept="image/*">
                            <img id="special-image-preview" class="preview-image" alt="Preview">
                        </div>
                        
                        <button type="submit" class="btn-primary-custom">
                            <i class="fas fa-save me-2"></i>Save Special
                        </button>
                    </form>
                </div>
                
                <div class="card">
                    <h4>Current Special</h4>
                    <div id="current-special-display" class="p-4 bg-light rounded">
                        <p class="text-muted">No special currently set. Create one above!</p>
                    </div>
                </div>
            </section>
            
            <!-- Gallery Management Section -->
            <section id="section-gallery" class="content-section">
                <div class="card">
                    <h4>Upload Gallery Images</h4>
                    <p class="text-muted mb-4">Add beautiful images to showcase your restaurant</p>
                    
                    <input type="file" id="gallery-upload-input" accept="image/*" multiple style="display: none;">
                    
                    <div class="image-upload-area" id="gallery-upload-area">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p><strong>Click to upload</strong> or drag and drop</p>
                        <p class="text-muted">PNG, JPG, JPEG (MAX. 5MB each)</p>
                    </div>
                    
                    <div id="upload-preview" class="image-preview-grid"></div>
                </div>
                
                <div class="card">
                    <h4>Current Gallery Images</h4>
                    <table class="gallery-table">
                        <thead>
                            <tr>
                                <th>Image</th>
                                <th>Filename</th>
                                <th>Uploaded</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="gallery-table-body">
                            <!-- Gallery items will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- Reservations Section -->
            <section id="section-reservations" class="content-section">
                <div class="card">
                    <h4>Recent Reservations</h4>
                    <p class="text-muted mb-4">Manage customer reservations and bookings</p>
                    
                    <table class="gallery-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Date & Time</th>
                                <th>Guests</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="reservations-table-body">
                            <tr>
                                <td colspan="6" class="text-center text-muted py-4">No reservations yet</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <!-- Toast Notification -->
    <div id="toast-notification" class="toast-notification">
        <div class="toast-header">
            <span class="toast-title" id="toast-title">Notification</span>
            <button class="toast-close" onclick="closeToast()">&times;</button>
        </div>
        <div class="toast-message" id="toast-message"></div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="confirm-modal">
        <div class="confirm-modal-content">
            <div class="confirm-modal-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h3 class="confirm-modal-title" id="confirm-title">Confirm Action</h3>
            <p class="confirm-modal-message" id="confirm-message">Are you sure you want to proceed?</p>
            <div class="confirm-modal-buttons">
                <button class="btn-primary-custom" id="confirm-yes">Yes, Proceed</button>
                <button class="btn-secondary-custom" id="confirm-no">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Demo Data Storage
        let adminData = {
            menuItems: [],
            specials: {},
            gallery: [
                { id: 1, filename: 'dish-1.jpg', url: 'https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=400', uploaded: '2024-10-01' },
                { id: 2, filename: 'interior-1.jpg', url: 'https://images.unsplash.com/photo-1559339352-11d035aa65de?w=400', uploaded: '2024-10-02' },
                { id: 3, filename: 'salad-1.jpg', url: 'https://images.unsplash.com/photo-1540189549336-e6e99c3679fe?w=400', uploaded: '2024-10-03' },
                { id: 4, filename: 'chef-1.jpg', url: 'https://images.unsplash.com/photo-1551218808-94e220e084d2?w=400', uploaded: '2024-10-04' },
                { id: 5, filename: 'customers-1.jpg', url: 'https://images.unsplash.com/photo-1552566626-52f8b828add9?w=400', uploaded: '2024-10-05' },
                { id: 6, filename: 'pancakes-1.jpg', url: 'https://images.unsplash.com/photo-1567620905732-2d1ec7ab7445?w=400', uploaded: '2024-10-06' }
            ],
            reservations: []
        };
        
        // Toast Notification System
        let toastTimeout;
        
        function showToast(title, message, type = 'success') {
            const toast = document.getElementById('toast-notification');
            const toastTitle = document.getElementById('toast-title');
            const toastMessage = document.getElementById('toast-message');
            
            toast.className = `toast-notification ${type} show`;
            toastTitle.textContent = title;
            toastMessage.textContent = message;
            
            clearTimeout(toastTimeout);
            toastTimeout = setTimeout(() => {
                closeToast();
            }, 4000);
        }
        
        function closeToast() {
            document.getElementById('toast-notification').classList.remove('show');
        }
        
        // Confirmation Modal System
        let confirmCallback = null;
        
        function showConfirm(title, message, onConfirm) {
            const modal = document.getElementById('confirm-modal');
            document.getElementById('confirm-title').textContent = title;
            document.getElementById('confirm-message').textContent = message;
            modal.classList.add('show');
            
            confirmCallback = onConfirm;
        }
        
        function closeConfirm() {
            document.getElementById('confirm-modal').classList.remove('show');
            confirmCallback = null;
        }
        
        document.getElementById('confirm-yes').addEventListener('click', function() {
            if (confirmCallback) confirmCallback();
            closeConfirm();
        });
        
        document.getElementById('confirm-no').addEventListener('click', closeConfirm);

        // Authentication
        const loginForm = document.getElementById('login-form');
        const loginPage = document.getElementById('login-page');
        const dashboard = document.getElementById('dashboard');
        const loginAlert = document.getElementById('login-alert');
        
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === 'admin' && password === 'admin123') {
                loginPage.style.display = 'none';
                dashboard.classList.add('active');
                loadDashboard();
            } else {
                showLoginAlert('Invalid credentials. Try admin / admin123', 'danger');
            }
        });
        
        function showLoginAlert(message, type) {
            loginAlert.innerHTML = `<div class="alert alert-${type}">${message}</div>`;
            loginAlert.style.display = 'block';
            setTimeout(() => { loginAlert.style.display = 'none'; }, 3000);
        }
        
        document.getElementById('logout-btn').addEventListener('click', function() {
            dashboard.classList.remove('active');
            loginPage.style.display = 'flex';
            loginForm.reset();
        });
        
        // Sidebar Navigation
        const menuLinks = document.querySelectorAll('.menu-link');
        const contentSections = document.querySelectorAll('.content-section');
        const pageTitle = document.getElementById('page-title');
        
        menuLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                menuLinks.forEach(l => l.classList.remove('active'));
                this.classList.add('active');
                
                const section = this.dataset.section;
                contentSections.forEach(s => s.classList.remove('active'));
                document.getElementById(`section-${section}`).classList.add('active');
                
                const titles = {
                    'overview': 'Dashboard Overview',
                    'menu-items': 'Manage Menu Items',
                    'specials': 'Manage Specials',
                    'gallery': 'Manage Gallery',
                    'reservations': 'Reservations'
                };
                pageTitle.textContent = titles[section];
                
                if (window.innerWidth <= 992) {
                    document.getElementById('sidebar').classList.remove('active');
                }
            });
        });
        
        document.getElementById('mobile-menu-btn').addEventListener('click', function() {
            document.getElementById('sidebar').classList.toggle('active');
        });
        
        // Initialize Sample Menu Items
        function initializeSampleMenuItems() {
            if (adminData.menuItems.length === 0) {
                adminData.menuItems = [
                    { id: 1, name: 'Continental Breakfast', category: 'breakfast', description: 'Fresh pastries, seasonal fruits, scrambled eggs, bacon, sausages, and your choice of coffee or tea', price: '5500', badge: 'popular', image: 'https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600' },
                    { id: 2, name: 'Truffle Pizza', category: 'pizza', description: 'Wood-fired artisan pizza topped with wild mushrooms, truffle oil, fresh mozzarella, and arugula', price: '8500', badge: 'signature', image: 'https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?w=600' },
                    { id: 3, name: 'Atlantic Salmon', category: 'mains', description: 'Perfectly grilled salmon fillet with lemon butter sauce, roasted vegetables, and herb-infused quinoa', price: '12000', badge: 'popular', image: 'https://images.unsplash.com/photo-1546039907-7fa05f864c02?w=600' },
                    { id: 4, name: 'Prime Ribeye Steak', category: 'mains', description: '12oz premium ribeye steak, grilled to perfection, served with truffle mashed potatoes and seasonal greens', price: '15500', badge: 'signature', image: 'https://images.unsplash.com/photo-1600891964092-4316c288032e?w=600' },
                    { id: 5, name: 'Chocolate Lava Cake', category: 'desserts', description: 'Decadent molten chocolate cake with a warm, gooey center, served with vanilla ice cream and berry compote', price: '4200', badge: 'signature', image: 'https://images.unsplash.com/photo-1587314168485-3236d6710814?w=600' },
                    { id: 6, name: 'Seafood Linguine', category: 'pasta', description: 'Fresh linguine with prawns, mussels, calamari in a rich garlic white wine sauce, topped with parsley', price: '9800', badge: 'signature', image: 'https://images.unsplash.com/photo-1563805042-7684c019e1cb?w=600' },
                    { id: 7, name: 'Caesar Salad', category: 'appetizers', description: 'Crisp romaine lettuce with parmesan cheese, croutons, and our signature Caesar dressing', price: '3500', badge: null, image: 'https://images.unsplash.com/photo-1546793665-c74683f339c1?w=600' },
                    { id: 8, name: 'Havilah Signature Burger', category: 'burgers', description: 'Angus beef patty with cheddar, caramelized onions, bacon, lettuce, tomato, and special sauce on brioche bun', price: '6500', badge: 'signature', image: 'https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=600' },
                    { id: 9, name: 'Freshly Brewed Coffee', category: 'beverages', description: 'Premium Arabica beans, available hot or iced. Choose from espresso, cappuccino, latte, or americano', price: '1500', badge: null, image: 'https://images.unsplash.com/photo-1511920170033-f8396924c348?w=600' },
                    { id: 10, name: 'Avocado Toast Deluxe', category: 'breakfast', description: 'Sourdough toast topped with smashed avocado, poached eggs, cherry tomatoes, and feta cheese', price: '4800', badge: 'vegetarian', image: 'https://images.unsplash.com/photo-1525351484163-7529414344d8?w=600' }
                ];
            }
        }
        
        // Menu Items Management
        function loadMenuItems(category = 'all') {
            const grid = document.getElementById('menu-items-grid');
            grid.innerHTML = '';
            
            const filteredItems = category === 'all' ? adminData.menuItems : adminData.menuItems.filter(item => item.category === category);
            
            if (filteredItems.length === 0) {
                grid.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: #666; padding: 40px;">No menu items yet. Click "Add New Item" to create one.</p>';
                return;
            }
            
            filteredItems.forEach(item => {
                const card = document.createElement('div');
                card.style.cssText = 'background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.1); transition: transform 0.3s ease;';
                card.onmouseover = () => card.style.transform = 'translateY(-5px)';
                card.onmouseout = () => card.style.transform = 'translateY(0)';
                
                const badgeHTML = item.badge ? `<span style="display: inline-block; padding: 4px 12px; background: ${getBadgeColor(item.badge)}; color: white; border-radius: 15px; font-size: 0.75rem; margin-top: 10px;">${getBadgeText(item.badge)}</span>` : '';
                const priceHTML = item.price ? `<p style="color: var(--secondary-color); font-size: 1.2rem; font-weight: 600; margin: 10px 0;">₦${Number(item.price).toLocaleString()}</p>` : '';
                
                card.innerHTML = `
                    <img src="${item.image}" alt="${item.name}" style="width: 100%; height: 200px; object-fit: cover;">
                    <div style="padding: 20px;">
                        <h4 style="color: var(--primary-color); margin-bottom: 10px; font-size: 1.1rem;">${item.name}</h4>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 10px; line-height: 1.6;">${item.description}</p>
                        ${priceHTML}
                        ${badgeHTML}
                        <div style="display: flex; gap: 10px; margin-top: 15px;">
                            <button class="btn-primary-custom" style="flex: 1; padding: 10px; font-size: 0.9rem;" onclick="editMenuItem(${item.id})">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn-danger-custom" style="flex: 1; padding: 10px;" onclick="deleteMenuItem(${item.id})">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }
        
        function getBadgeColor(badge) {
            const colors = { 'signature': '#8B4513', 'popular': '#D4AF37', 'chef': '#2C5F2D', 'vegetarian': '#2C5F2D', 'new': '#dc3545' };
            return colors[badge] || '#6c757d';
        }
        
        function getBadgeText(badge) {
            const texts = { 'signature': 'Signature Dish', 'popular': 'Popular Choice', 'chef': "Chef's Special", 'vegetarian': 'Vegetarian', 'new': 'New Item' };
            return texts[badge] || badge;
        }
        
        function filterMenuByCategory() {
            loadMenuItems(document.getElementById('category-filter').value);
        }
        
        function showAddMenuItemModal() {
            document.getElementById('modal-title').textContent = 'Add New Menu Item';
            document.getElementById('menu-item-form').reset();
            document.getElementById('item-image-preview').classList.remove('active');
            document.getElementById('edit-item-id').value = '';
            document.getElementById('menu-item-modal').style.display = 'block';
        }
        
        function editMenuItem(id) {
            const item = adminData.menuItems.find(i => i.id === id);
            if (!item) return;
            
            document.getElementById('modal-title').textContent = 'Edit Menu Item';
            document.getElementById('edit-item-id').value = id;
            document.getElementById('item-name').value = item.name;
            document.getElementById('item-category').value = item.category;
            document.getElementById('item-description').value = item.description;
            document.getElementById('item-price').value = item.price || '';
            document.getElementById('item-badge').value = item.badge || '';
            
            const preview = document.getElementById('item-image-preview');
            preview.src = item.image;
            preview.classList.add('active');
            
            document.getElementById('menu-item-modal').style.display = 'block';
        }
        
        function closeMenuItemModal() {
            document.getElementById('menu-item-modal').style.display = 'none';
        }
        
        function deleteMenuItem(id) {
            showConfirm(
                'Delete Menu Item',
                'Are you sure you want to delete this menu item? This action cannot be undone.',
                function() {
                    adminData.menuItems = adminData.menuItems.filter(item => item.id !== id);
                    loadMenuItems(document.getElementById('category-filter').value);
                    updateStats();
                    saveData();
                    showToast('Success', 'Menu item deleted successfully', 'success');
                }
            );
        }
        
        // Menu Item Form
        document.getElementById('item-image').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('item-image-preview');
                    preview.src = e.target.result;
                    preview.classList.add('active');
                };
                reader.readAsDataURL(file);
            }
        });
        
        document.getElementById('menu-item-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const itemId = document.getElementById('edit-item-id').value;
            const imagePreview = document.getElementById('item-image-preview');
            
            const itemData = {
                id: itemId ? parseInt(itemId) : Date.now(),
                name: document.getElementById('item-name').value,
                category: document.getElementById('item-category').value,
                description: document.getElementById('item-description').value,
                price: document.getElementById('item-price').value || null,
                badge: document.getElementById('item-badge').value || null,
                image: imagePreview.src || 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=600'
            };
            
            if (itemId) {
                const index = adminData.menuItems.findIndex(i => i.id === parseInt(itemId));
                if (index !== -1) {
                    adminData.menuItems[index] = itemData;
                }
                showToast('Success', 'Menu item updated successfully', 'success');
            } else {
                if (!Array.isArray(adminData.menuItems)) {
                    adminData.menuItems = [];
                }
                adminData.menuItems.push(itemData);
                showToast('Success', 'Menu item added successfully', 'success');
            }
            
            loadMenuItems(document.getElementById('category-filter').value);
            closeMenuItemModal();
            updateStats();
            saveData();
        });
        
        // Specials Management
        document.getElementById('special-image').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('special-image-preview').src = e.target.result;
                    document.getElementById('special-image-preview').classList.add('active');
                };
                reader.readAsDataURL(file);
            }
        });
        
        document.getElementById('specials-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const specialData = {
                title: document.getElementById('special-title').value,
                type: document.getElementById('special-type').value,
                description: document.getElementById('special-description').value,
                originalPrice: document.getElementById('special-original-price').value,
                price: document.getElementById('special-price').value,
                image: document.getElementById('special-image-preview').src || 'https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?w=600'
            };
            
            adminData.specials = specialData;
            displayCurrentSpecial(specialData);
            showToast('Success', 'Special offer saved successfully', 'success');
            updateStats();
            saveData();
        });
        
        function displayCurrentSpecial(special) {
            document.getElementById('current-special-display').innerHTML = `
                <div class="row align-items-center">
                    <div class="col-md-4">
                        <img src="${special.image}" alt="${special.title}" style="width: 100%; border-radius: 10px;">
                    </div>
                    <div class="col-md-8">
                        <span class="badge bg-success mb-2">${special.type}</span>
                        <h5 class="mb-3">${special.title}</h5>
                        <p class="text-muted">${special.description}</p>
                        <div class="mt-3">
                            ${special.originalPrice ? '<span class="text-decoration-line-through text-muted me-2">₦' + special.originalPrice + '</span>' : ''}
                            <span class="h4 text-success">₦${special.price}</span>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Gallery Management
        const galleryUploadArea = document.getElementById('gallery-upload-area');
        const galleryUploadInput = document.getElementById('gallery-upload-input');
        
        galleryUploadArea.addEventListener('click', () => galleryUploadInput.click());
        
        galleryUploadInput.addEventListener('change', function(e) {
            handleGalleryFiles(e.target.files);
        });
        
        function handleGalleryFiles(files) {
            const uploadPreview = document.getElementById('upload-preview');
            uploadPreview.innerHTML = '';
            
            Array.from(files).forEach(file => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const preview = document.createElement('div');
                        preview.className = 'image-preview-item';
                        preview.innerHTML = `
                            <img src="${e.target.result}" alt="Preview">
                            <div class="image-preview-overlay">
                                <button class="btn-primary-custom btn-sm" onclick="uploadGalleryImage('${e.target.result}', '${file.name}')">
                                    <i class="fas fa-upload"></i> Upload
                                </button>
                            </div>
                        `;
                        uploadPreview.appendChild(preview);
                    };
                    reader.readAsDataURL(file);
                }
            });
        }
        
        function uploadGalleryImage(imageData, filename) {
            const newImage = { id: Date.now(), filename: filename, url: imageData, uploaded: new Date().toISOString().split('T')[0] };
            adminData.gallery.push(newImage);
            loadGalleryTable();
            document.getElementById('upload-preview').innerHTML = '';
            galleryUploadInput.value = '';
            showToast('Success', 'Image uploaded successfully', 'success');
            updateStats();
            saveData();
        }
        
        function loadGalleryTable() {
            const tbody = document.getElementById('gallery-table-body');
            tbody.innerHTML = '';
            
            if (adminData.gallery.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" class="text-center text-muted py-4">No images in gallery</td></tr>';
                return;
            }
            
            adminData.gallery.forEach(image => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><img src="${image.url}" alt="${image.filename}"></td>
                    <td>${image.filename}</td>
                    <td>${image.uploaded}</td>
                    <td class="table-actions">
                        <button class="btn-danger-custom" onclick="deleteGalleryImage(${image.id})">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function deleteGalleryImage(id) {
            showConfirm(
                'Delete Image',
                'Are you sure you want to delete this image from the gallery?',
                function() {
                    adminData.gallery = adminData.gallery.filter(img => img.id !== id);
                    loadGalleryTable();
                    updateStats();
                    saveData();
                    showToast('Success', 'Image deleted successfully', 'success');
                }
            );
        }
        
        // Reservations Management
        function loadReservations() {
            const tbody = document.getElementById('reservations-table-body');
            
            if (adminData.reservations.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="text-center text-muted py-4">No reservations yet</td></tr>';
                return;
            }
            
            tbody.innerHTML = '';
            adminData.reservations.forEach((reservation, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${reservation.name}</td>
                    <td>${reservation.email}</td>
                    <td>${reservation.date} at ${reservation.time}</td>
                    <td>${reservation.guests}</td>
                    <td><span class="badge bg-${reservation.status === 'confirmed' ? 'success' : 'warning'}">${reservation.status}</span></td>
                    <td class="table-actions">
                        <button class="btn-primary-custom btn-sm" onclick="updateReservationStatus(${index}, 'confirmed')">
                            <i class="fas fa-check"></i> Confirm
                        </button>
                        <button class="btn-danger-custom" onclick="deleteReservation(${index})">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function updateReservationStatus(index, status) {
            adminData.reservations[index].status = status;
            loadReservations();
            saveData();
            showToast('Success', 'Reservation status updated successfully', 'success');
        }
        
        function deleteReservation(index) {
            showConfirm(
                'Cancel Reservation',
                'Are you sure you want to cancel this reservation?',
                function() {
                    adminData.reservations.splice(index, 1);
                    loadReservations();
                    updateStats();
                    saveData();
                    showToast('Success', 'Reservation cancelled successfully', 'success');
                }
            );
        }
        
        // Update Statistics
        function updateStats() {
            document.getElementById('total-menu-items').textContent = adminData.menuItems.length;
            document.getElementById('total-reservations').textContent = adminData.reservations.length;
            document.getElementById('total-images').textContent = adminData.gallery.length;
            document.getElementById('active-specials').textContent = Object.keys(adminData.specials).length > 0 ? '1' : '0';
        }
        
        // Data Persistence
        function saveData() {
            try {
                localStorage.setItem('havilahAdminData', JSON.stringify(adminData));
            } catch (e) {
                showToast('Error', 'Failed to save data', 'error');
            }
        }
        
        function loadData() {
            try {
                const savedData = localStorage.getItem('havilahAdminData');
                if (savedData) {
                    const parsed = JSON.parse(savedData);
                    // Ensure all required properties exist
                    adminData.menuItems = parsed.menuItems || [];
                    adminData.specials = parsed.specials || {};
                    adminData.gallery = parsed.gallery || adminData.gallery;
                    adminData.reservations = parsed.reservations || [];
                }
            } catch (e) {
                showToast('Error', 'Failed to load saved data', 'error');
            }
        }
        
        setInterval(saveData, 30000);
        window.addEventListener('load', loadData);
        window.addEventListener('beforeunload', saveData);
        
        // Load Dashboard
        function loadDashboard() {
            loadData(); // Load saved data first
            initializeSampleMenuItems();
            loadMenuItems();
            loadGalleryTable();
            loadReservations();
            updateStats();
            
            if (adminData.specials && adminData.specials.title) {
                displayCurrentSpecial(adminData.specials);
            }
        }
    </script>
</body>
</html>